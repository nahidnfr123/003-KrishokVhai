(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/Tqy":function(t,e,r){var s=r("TTEv");"string"==typeof s&&(s=[[t.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(s,a);s.locals&&(t.exports=s.locals)},"2WYk":function(t,e,r){"use strict";var s=r("o0o1"),a=r.n(s);function n(t,e,r,s,a,n,i){try{var o=t[n](i),c=o.value}catch(t){return void r(t)}o.done?e(c):Promise.resolve(c).then(s,a)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(s,a){var i=t.apply(e,r);function o(t){n(i,s,a,o,c,"next",t)}function c(t){n(i,s,a,o,c,"throw",t)}o(void 0)}))}}var o={name:"AddressSelectComponent",props:{address:String,errors:{type:Array|Object}},data:function(){return{countries:{},states:{},cities:{},userDetails:{country_id:"",state_id:"",city_id:"",address:""}}},watch:{"userDetails.country_id":function(t,e){t!=e&&(this.getStates(),this.$emit("updateAddressValues",this.userDetails))},"userDetails.state_id":function(t,e){t!=e&&(this.getCities(),this.$emit("updateAddressValues",this.userDetails))},"userDetails.city_id":function(t,e){t!=e&&this.$emit("updateAddressValues",this.userDetails)},"userDetails.address":function(t,e){t!=e&&this.$emit("updateAddressValues",this.userDetails)}},methods:{updateValue:function(t){this.$emit("input",t.trim())},getCountries:function(){var t=this;return i(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/countries").then((function(e){t.countries=e.data})).catch((function(t){dispatch("snackbar/addSnack",{color:"danger",msg:"Error fetching countries.",snakbarType:"Error"},{root:!0})}));case 2:case"end":return e.stop()}}),e)})))()},getStates:function(){var t=this;return i(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/states/".concat(t.userDetails.country_id)).then((function(e){t.states=e.data})).catch((function(t){dispatch("snackbar/addSnack",{color:"danger",msg:"Error fetching states.",snakbarType:"Error"},{root:!0})}));case 2:case"end":return e.stop()}}),e)})))()},getCities:function(){var t=this;return i(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/cities/".concat(t.userDetails.state_id)).then((function(e){t.cities=e.data})).catch((function(t){dispatch("snackbar/addSnack",{color:"danger",msg:"Error fetching cities.",snakbarType:"Error"},{root:!0})}));case 2:case"end":return e.stop()}}),e)})))()}},computed:{},mounted:function(){this.getCountries()}},c=(r("P42d"),r("KHd+")),d=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"form-group mb-3"},[r("label",{attrs:{for:"Country"}},[t._v("Country (*)")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userDetails.country_id,expression:"userDetails.country_id"}],staticClass:"form-control form-control-sm",attrs:{name:"country",id:"Country",disabled:!t.countries.length},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userDetails,"country_id",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"",selected:""}},[t._v("---------")]),t._v(" "),t._l(t.countries,(function(e,s){return r("option",{key:s,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),(t.errors.country_id&&Array.isArray(t.errors.country_id)?t.errors.country_id[0]:t.errors.country_id)?[r("p",{staticClass:"text-danger mt-1"},[t._v(t._s(t.errors.country_id&&Array.isArray(t.errors.country_id)?t.errors.country_id[0]:t.errors.country_id))])]:t._e()],2),t._v(" "),r("div",{staticClass:"form-group mb-3"},[r("label",{attrs:{for:"State"}},[t._v("State/Province (*)")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userDetails.state_id,expression:"userDetails.state_id"}],staticClass:"form-control form-control-sm",attrs:{name:"state",id:"State",disabled:!t.states.length},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userDetails,"state_id",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"",selected:""}},[t._v("---------")]),t._v(" "),t._l(t.states,(function(e,s){return r("option",{key:s,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),(t.errors.state_id&&Array.isArray(t.errors.state_id)?t.errors.state_id[0]:t.errors.state_id)?[r("p",{staticClass:"text-danger mt-1"},[t._v(t._s(t.errors.state_id&&Array.isArray(t.errors.state_id)?t.errors.state_id[0]:t.errors.state_id))])]:t._e()],2),t._v(" "),r("div",{staticClass:"form-group mb-3"},[r("label",{attrs:{for:"City"}},[t._v("City")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userDetails.city_id,expression:"userDetails.city_id"}],staticClass:"form-control form-control-sm",attrs:{name:"city",id:"City",disabled:!t.cities.length},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userDetails,"city_id",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"",selected:""}},[t._v("---------")]),t._v(" "),t._l(t.cities,(function(e,s){return r("option",{key:s,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),(t.errors.city_id&&Array.isArray(t.errors.city_id)?t.errors.city_id[0]:t.errors.city_id)?[r("p",{staticClass:"text-danger mt-1"},[t._v(t._s(t.errors.city_id&&Array.isArray(t.errors.city_id)?t.errors.city_id[0]:t.errors.city_id))])]:t._e()],2),t._v(" "),r("div",{staticClass:"form-group mb-3"},["agricultural-officer"==this.$route.params.usertype?r("label",{attrs:{for:"address"}},[t._v("Office Address (*)")]):r("label",{attrs:{for:"address"}},[t._v("Address (*)")]),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userDetails.address,expression:"userDetails.address"}],staticClass:"form-control form-control-sm",attrs:{cols:"10",rows:"3",id:"address",name:"address"},domProps:{value:t.userDetails.address},on:{input:function(e){e.target.composing||t.$set(t.userDetails,"address",e.target.value)}}}),t._v(" "),(t.errors.address&&Array.isArray(t.errors.address)?t.errors.address[0]:t.errors.address)?[r("p",{staticClass:"text-danger mt-1"},[t._v(t._s(t.errors.address&&Array.isArray(t.errors.address)?t.errors.address[0]:t.errors.address))])]:t._e()],2)])}),[],!1,null,"1d20d891",null);e.a=d.exports},"5CdS":function(t,e,r){"use strict";r("SCdx")},P42d:function(t,e,r){"use strict";r("/Tqy")},Rc3N:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,".fullPageLoader[data-v-2dfc4c0b]{position:absolute;top:0;left:0;height:100vh;width:100vw;z-index:1000;background-color:rgba(20,20,20,.5);overflow:hidden!important}",""])},SCdx:function(t,e,r){var s=r("Rc3N");"string"==typeof s&&(s=[[t.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(s,a);s.locals&&(t.exports=s.locals)},TTEv:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,"textarea[data-v-1d20d891]{resize:none}",""])},hIk9:function(t,e,r){"use strict";r.r(e);var s=r("o0o1"),a=r.n(s),n=r("L2JU");function i(t,e,r,s,a,n,i){try{var o=t[n](i),c=o.value}catch(t){return void r(t)}o.done?e(c):Promise.resolve(c).then(s,a)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(s,a){var n=t.apply(e,r);function o(t){i(n,s,a,o,c,"next",t)}function c(t){i(n,s,a,o,c,"throw",t)}o(void 0)}))}}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l={name:"CheckOut",components:{AddressSelectComponent:r("2WYk").a},data:function(){return{onlinePaymentSubmit:!1,paymentMethod:"cashOnDelivery",loading:!1,showAddressForm:"",userAddressForm:{address:"",country_id:"",state_id:"",city_id:""},userDetails:{},addressId:0,errors:"",cartDataOrder:{},total_price:0}},computed:d(d({},Object(n.c)({user:"auth/user"})),{},{cart:function(){return this.$store.state.cart.cart},cartTotal:function(){var t=this.cart.reduce((function(t,e){return t+e.regular_price*e.quantity}),0);return this.total_price=t,t.toLocaleString("en-BN",{style:"currency",currency:"BDT"})}}),mounted:function(){this.getCart(),this.getUserAddress()},methods:d(d({},Object(n.b)({getCart:"cart/getCart"})),{},{itemTotal:function(t){return(t.regular_price*t.quantity).toLocaleString("en-BN",{style:"currency",currency:"BDT"})},getUserAddress:function(){var t=this;return o(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,axios.get("api/user/address").then((function(e){t.userDetails=e.data.data})).catch((function(t){console.log(t)})).finally((function(){return t.loading=!1}));case 3:case"end":return e.stop()}}),e)})))()},closeForm:function(){this.showAddressForm=!1,this.clearForm()},clearForm:function(){this.userAddressForm={address:"",country_id:"",state_id:"",city_id:""}},updateAddressData:function(t){this.showAddressForm=!0,this.userAddressForm.address=t.address,this.userAddressForm.country_id=t.country_id,this.userAddressForm.state_id=t.state_id,this.userAddressForm.city_id=t.city_id},addNewAddress:function(){var t=this;return o(a.a.mark((function e(){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t).$Progress.start(),r.errors=[],r.userAddressForm.address.trim()||(r.errors.address="Address is required."),r.userAddressForm.country_id.toString().trim()||(r.errors.country_id="Country is required."),r.userAddressForm.state_id.toString().trim()||(r.errors.state_id="State/province  is required."),!Object.keys(r.errors).length){e.next=9;break}return r.$Progress.fail(),e.abrupt("return");case 9:return e.next=11,axios.post("api/user/add-address",t.userAddressForm).then((function(e){t.userDetails=e.data.data,t.closeForm()})).catch((function(t){console.log(t)})).finally((function(){r.$Progress.finish()}));case 11:case"end":return e.stop()}}),e)})))()},removeAddress:function(t){var e=this;return o(a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.$Progress.start(),r.next=3,axios.delete("api/user/address/remove/"+t).then((function(t){e.userDetails=t.data.data})).catch((function(t){console.log(t)})).finally((function(){e.$Progress.finish()}));case 3:case"end":return r.stop()}}),r)})))()},confirmOrder:function(){var t=this;return o(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$Progress.start(),!t.$store.state.cart.cart||Object.keys(t.$store.state.cart.cart).length){e.next=6;break}return e.next=4,t.$store.dispatch("snackbar/addSnack",{color:"danger",msg:"Cart is empty.",snakbarType:"Error"},{root:!0});case 4:return t.$Progress.fail(),e.abrupt("return");case 6:if(t.addressId){e.next=11;break}return e.next=9,t.$store.dispatch("snackbar/addSnack",{color:"danger",msg:"Please select address.",snakbarType:"Error"},{root:!0});case 9:return t.$Progress.fail(),e.abrupt("return");case 11:if("onlinePayment"!==t.paymentMethod){e.next=17;break}return t.onlinePaymentSubmit=!0,e.next=15,t.proceedToPayment();case 15:e.next=19;break;case 17:return e.next=19,t.placeOrder();case 19:case"end":return e.stop()}}),e)})))()},placeOrder:function(){var t=this;return o(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.post("api/product/order",{address_id:t.addressId,total_price:t.total_price,payment_method:t.paymentMethod,cartData:t.$store.state.cart.cart}).then((function(e){t.$store.dispatch("cart/clearCart"),t.clearForm(),window.location.href="dashboard/@".concat(t.user.username,"/products/orders")})).catch((function(t){console.log(t)})).finally((function(){t.$Progress.finish()}));case 2:case"end":return e.stop()}}),e)})))()},proceedToPayment:function(){return o(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!1);case 1:case"end":return t.stop()}}),t)})))()}})},v=(r("5CdS"),r("KHd+")),m=Object(v.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[t.onlinePaymentSubmit?r("div",{staticClass:"fullPageLoader"},[t._m(0)]):t._e(),t._v(" "),r("div",{staticClass:"col-12 col-md-12 col-lg-12 m-auto mb-4"},[r("h3",{staticClass:"text-center mt-4 text-muted"},[t._v("Checkout")]),t._v(" "),r("hr"),t._v(" "),t.cart.length?r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 col-lg-12 col-xl-7"},[r("table",{staticClass:"table",staticStyle:{"min-width":"100%"}},[t._m(1),t._v(" "),r("tbody",[t._l(t.cart,(function(e,s){return r("tr",{key:e.id},[r("th",{attrs:{scope:"row"}},[t._v(t._s(s))]),t._v(" "),r("td",[r("img",{staticClass:"img-fluid rounded",staticStyle:{height:"40px!important","margin-right":"10px !important"},attrs:{src:e.first_image,alt:""}})]),t._v(" "),r("td",[t._v(t._s(e.product_name))]),t._v(" "),r("td",[t._v("\n                            "+t._s(e.quantity)+" "+t._s(e.stock_type)+"\n                        ")]),t._v(" "),r("td",[t._v(t._s(t.itemTotal(e)))]),t._v(" "),r("td")])})),t._v(" "),r("tr",[r("td"),t._v(" "),r("td",{staticClass:"font-bold"},[t._v("Total Amount")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",{staticClass:"font-bold"},[t._v(t._s(t.cartTotal))])])],2)])]),t._v(" "),t.loading?t._e():r("div",{staticClass:"col-12 col-lg-12 col-xl-5 mt-4"},[r("h6",[t._v("Payment method:")]),t._v(" "),r("div",{staticClass:"form-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentMethod,expression:"paymentMethod"}],staticClass:"form-group",attrs:{type:"radio",id:"cashOnDelivery",name:"paymentOptions",value:"cashOnDelivery"},domProps:{checked:t._q(t.paymentMethod,"cashOnDelivery")},on:{change:function(e){t.paymentMethod="cashOnDelivery"}}}),t._v(" "),r("label",{attrs:{for:"cashOnDelivery"}},[t._v("Cash on delivery")]),t._v(" "),r("br"),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentMethod,expression:"paymentMethod"}],staticClass:"form-group",attrs:{type:"radio",id:"onlinePayment",name:"paymentOptions",value:"onlinePayment"},domProps:{checked:t._q(t.paymentMethod,"onlinePayment")},on:{change:function(e){t.paymentMethod="onlinePayment"}}}),t._v(" "),r("label",{attrs:{for:"onlinePayment"}},[t._v("Online payment")])]),t._v(" "),r("hr"),t._v(" "),r("h6",[t._v("Address")]),t._v(" "),r("div",{staticClass:"mb-2"},[t.userDetails&&Object.keys(t.userDetails).length&&t.userDetails.address?t._l(t.userDetails.address,(function(e,s){return r("div",{staticClass:"d-flex align-items-center justify-content-between p-2 rounded",class:[t.addressId==e.id?"bg-gray":""]},[r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.addressId,expression:"addressId"}],staticStyle:{"margin-right":"10px"},attrs:{type:"radio",name:"addressCheck",id:"addressCheck"+e.id},domProps:{value:e.id,checked:t._q(t.addressId,e.id)},on:{change:function(r){t.addressId=e.id}}}),t._v(" "),r("label",{staticClass:"font-bold",attrs:{for:"addressCheck"+e.id}},[r("span",[t._v(t._s(e.address))]),t._v(" "),e.city?r("span",[t._v(", "+t._s(t._f("capitalize")(e.city.name)))]):t._e(),t._v(" "),e.state?r("span",[t._v(", "+t._s(t._f("capitalize")(e.state.name)))]):t._e(),t._v(" "),e.country?r("span",[t._v(", "+t._s(t._f("capitalize")(e.country.name)))]):t._e()])]),t._v(" "),0!=s?r("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(r){return r.stopPropagation(),r.preventDefault(),t.removeAddress(e.id)}}},[r("i",{staticClass:"fas fa-times"})]):t._e()])})):r("div",[t.loading?t._e():r("div",{staticClass:"alert-danger alert"},[t._v("\n                            No address found.\n                        ")])])],2),t._v(" "),r("hr"),t._v(" "),r("div",[!t.showAddressForm&&t.userDetails.address&&Object.keys(t.userDetails.address).length<3?r("button",{staticClass:"btn btn-success btn-sm",on:{click:function(e){t.showAddressForm=!0}}},[t._v("\n                        Add new address\n                    ")]):t._e(),t._v(" "),t.userDetails.address&&Object.keys(t.userDetails.address).length<3?[t.showAddressForm?r("form",{attrs:{action:""}},[r("h4",[t._v("Add new address")]),t._v(" "),r("address-select-component",{attrs:{address:t.userAddressForm.address,errors:this.errors},on:{updateAddressValues:function(e){return t.updateAddressData(e)}}}),t._v(" "),r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("button",{staticClass:"btn btn-sm btn-danger text-white rounded",on:{click:function(e){return t.closeForm()}}},[t._v("Close")]),t._v(" "),r("button",{staticClass:"btn btn-sm btn-primary text-white rounded",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addNewAddress()}}},[t._v("Save")])])],1):t._e()]:r("div",[t.loading?t._e():r("div",{staticClass:"alert-danger alert"},[t._v("\n                            Already 3 address is added can't add more.\n                        ")])])],2),t._v(" "),r("br"),t._v(" "),r("button",{staticClass:"btn btn-warning pull-right mb-2",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.confirmOrder()}}},[t._v("Confirm Order")])])]):r("div",[r("div",{staticClass:"alert alert-danger text-center"},[t._v("Cart is empty!")])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex justify-content-center align-items-center align-content-center text-white",staticStyle:{height:"100%",width:"100%"}},[e("div",{staticClass:"text-center"},[e("div",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}),this._v(" "),e("div",[this._v("Initiating online payment process...")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),r("th",{staticStyle:{"max-width":"60px !important"},attrs:{scope:"col"}},[t._v("Image")]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("Item")]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("Quantity")]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("Price")])])])}],!1,null,"2dfc4c0b",null);e.default=m.exports}}]);